<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EEIO Dashboard — JavaScript Version</title>

  <!-- Plotly for visualization -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

  <style>
    body { font-family: Inter, system-ui, Arial; max-width:900px; margin:28px auto; padding:12px; }
    .card{ border-radius:12px; box-shadow:0 6px 18px rgba(20,20,30,0.06); padding:16px; margin-bottom:16px }
    label{ display:block; margin:8px 0 4px }
    button{ padding:8px 12px; border-radius:8px; border:0; cursor:pointer }
    pre{ background:#0f1724; color:#e6edf3; padding:12px; border-radius:8px; overflow:auto }
    h2{ margin-top:24px; }
  </style>
</head>
<body>
  <h1>Environmentally-Extended IO — Ghosh model (JS demo)</h1>

  <!-- EEIO Demo Card -->
  <div class="card">
    <h2>EEIO Ghosh Example (130 sectors)</h2>
    <p>Click below to generate artificial EEIO results for demonstration.</p>
    <button id="runExampleBtn">Load Example EEIO</button>
    <div id="status">No run yet.</div>
    <pre id="results">(results will appear here)</pre>
  </div>

  <!-- Scenario Visualization Card -->
  <div class="card">
    <h2>Scenario Visualization (2000–2050)</h2>
    <p>This is an interactive example of 5 scenarios over time.</p>
    <div id="bar-plot" style="width:100%;height:400px;"></div>
    <div id="line-plot" style="width:100%;height:400px;"></div>
  </div>

  <script>
    // ------------------- EEIO Demo -------------------
    function runEeiOExample(){
      const status = document.getElementById('status');
      const resultsEl = document.getElementById('results');
      status.innerText = 'Generating example dataset...';

      const n = 130;
      // artificial matrices
      let Z = Array.from({length:n}, ()=>Array.from({length:n}, ()=>Math.random()*0.2));
      let x = Array.from({length:n}, ()=>Math.random()*900+100);
      let e = Array.from({length:n}, ()=>Math.random()*2+0.01);

      // Compute "footprints" (simplified version)
      let footprints = Z.map((row,i)=>row.reduce((sum,j)=>sum + j*e[i],0));
      let total_env_current = x.map((val,i)=>val*e[i]);

      // Top 10 by footprints
      let idx = footprints.map((v,i)=>[i,v]).sort((a,b)=>b[1]-a[1]).slice(0,10);
      let s = 'Top 10 sectors (index, footprint multiplier):\n';
      idx.forEach(([i,v])=>s+=`${i}\t${v.toFixed(6)}\n`);

      // Top 10 by total environment
      let idx2 = total_env_current.map((v,i)=>[i,v]).sort((a,b)=>b[1]-a[1]).slice(0,10);
      s+='\nTotal environment (current output) - top 10 sectors:\n';
      idx2.forEach(([i,v])=>s+=`${i}\t${v.toFixed(6)}\n`);

      resultsEl.innerText = s;
      status.innerText = 'Example run complete.';
    }

    document.getElementById('runExampleBtn').addEventListener('click', runEeiOExample);

    // ------------------- Scenario Visualization -------------------
    const years = [];
    for(let y=2000; y<=2050; y+=5) years.push(y);

    const scenarios = {};
    for(let i=1;i<=5;i++){
      scenarios[`Scenario ${i}`] = years.map(()=>Math.floor(Math.random()*150)+50);
    }

    // Bar Plot
    const barData = Object.keys(scenarios).map(key=>({
      x: years,
      y: scenarios[key],
      name: key,
      type: 'bar'
    }));
    Plotly.newPlot('bar-plot', barData, {barmode:'group', title:'Scenario Comparison (Bar Plot)'});

    // Line Plot
    const lineData = Object.keys(scenarios).map(key=>({
      x: years,
      y: scenarios[key],
      name: key,
      mode:'lines+markers'
    }));
    Plotly.newPlot('line-plot', lineData, {title:'Scenario Comparison (Line Plot)'});
  </script>
</body>
</html>
